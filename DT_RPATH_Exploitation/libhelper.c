/*
 * libhelper.c - Legitimate Helper Library
 *
 * This is the REAL library that the victim program expects to use.
 * It provides helper functions that the victim relies on.
 *
 * Compile: gcc -shared -fPIC -o libhelper.so libhelper.c
 *
 * EDUCATIONAL PURPOSES ONLY
 */

#include <stdio.h>
#include <string.h>

/* Color codes */
#define GREEN   "\033[1;32m"
#define RESET   "\033[0m"

/* Library initialization */
__attribute__((constructor))
void libhelper_init(void) {
    fprintf(stderr, GREEN "[libhelper.so]" RESET " Legitimate library loaded\n");
}

/* Helper function: Process user data */
int process_data(const char *data) {
    printf("[libhelper] Processing data: %s\n", data);
    return strlen(data);
}

/* Helper function: Validate input */
int validate_input(const char *input) {
    if (!input || strlen(input) == 0) {
        printf("[libhelper] Validation failed: empty input\n");
        return 0;
    }
    printf("[libhelper] Input validated successfully\n");
    return 1;
}

/* Helper function: Get library version */
const char *get_version(void) {
    return "1.0.0 (legitimate)";
}

/* Helper function: Perform sensitive operation */
int sensitive_operation(const char *auth_token) {
    printf("[libhelper] Performing sensitive operation...\n");
    printf("[libhelper] Auth token: %s\n", auth_token);
    printf("[libhelper] Operation completed securely.\n");
    return 0;
}
